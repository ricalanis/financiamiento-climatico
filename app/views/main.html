<div id="introduction" class="row">
  <div class="small-12 large-12 columns">
    <h3>Financiamiento internacional para cambio climático en México</h3>
    <p>¿Qué es? es un mapa para visualizar manera geográfica el financiamiento
      climático que ha sido invertido a nivel nacional y estatal en México.</p>
  </div>

  <div class="small-12 large-9 columns">
    <mexico-map></mexico-map>
  </div>

  <div class="small-12 large-3 columns">
    <select class="map__filter" ng-model="main.filters.year" ng-options="year for year in main.options.years">
      <option value="">Todos los a&ntilde;os</option>
    </select>
    <select class="map__filter" ng-model="main.filters.state" ng-options="state for state in main.states">
      <option value="">Todos los estados</option>
    </select>
    <select class="map__filter" ng-model="main.filters.financing" ng-options="financing for financing in main.options.financing">
      <option value="">Cualquier financiamiento</option>
    </select>
    <select class="map__filter" ng-model="main.filters.focus" ng-options="focus for focus in main.options.focus">
      <option value="">Cualquier enfoques</option>
    </select>
    <select class="map__filter" ng-model="main.filters.status" ng-options="status for status in main.options.status">
      <option value="">Cualquier status</option>
    </select>

    <p class="map__legend"><strong>Precios en d&oacute;lares (USD)</strong></p>
    <p class="map__legend"><span style="background-color: {{main.investmentColors[0]}};"></span>1 a 99,999</p>
    <p class="map__legend"><span style="background-color: {{main.investmentColors[1]}};"></span>100,000 a 999,999</p>
    <p class="map__legend"><span style="background-color: {{main.investmentColors[2]}};"></span>1M a 9,999,999</p>
    <p class="map__legend"><span style="background-color: {{main.investmentColors[3]}};"></span>M&aacute;s de 10M</p>

  </div>
</div>

<div id="totalInvestmenFooter" class="row">
  <div class="small-12 large-6 columns text-center
  small-12 large-6 columns text-center">
    <h3>{{ main.kpis.investment | humanizeInt }} USD</h3>
    <p>Millones de d&oacute;lares invertidos</p>
  </div>
  <div class="small-12 large-6 columns text-center
  small-12 large-6 columns text-center">
    <h3>{{ main.results.length | humanizeInt }}</h3>
    <p>Proyectos de inversión</p>
  </div>
</div>

<div ng-show="main.filtersAvailable()" class="row filters__tags">
  <!-- Dynamic closable tags -->
  <closable-tag value="main.filters.year"></closable-tag>
  <closable-tag value="main.filters.state"></closable-tag>
  <closable-tag value="main.filters.financing"></closable-tag>
  <closable-tag value="main.filters.focus"></closable-tag>
  <closable-tag value="main.filters.status"></closable-tag>
</div>

<div class="deck">
  <input class="map__filter" ng-model="main.filters.project" type="text" placeholder="Buscar proyecto por nombre">
  <div class="table__card">
    <ul>
      <accordion close-others="false">
        <accordion-group dir-paginate="record in ( main.results = (
                        main.data.records |
                        filter:{
                          'region': main.filters.state,
                          'ano_aprobacion': main.filters.year,
                          'financiamiento': main.filters.financing,
                          'area_proyecto': main.filters.focus,
                          'status': main.filters.status
                        } |
                        filter: main.filters.project ) ) | itemsPerPage: 10"
                        is-open="main.isOpen[$index]">
          <accordion-heading>
            <li class="table--row" ng-class="{ 'selected': main.isOpen[$index] }">
              <div class="row--title">{{ record.nombre_proyecto }}</div>
              <div class="row--subtitle">{{ record.region }}</div>
              <div class="row--footer text-right">${{ record.cantidad | humanizeInt }}.00</div>
            </li>
          </accordion-heading>

          <table>
            <tr>
              <td class="record__property">Donante de fondo</td>
              <td>{{ record.donante_fondo }}</td>
            </tr>

            <tr>
              <td class="record__property">Beneficiario</td>
              <td>{{ record.beneficiario }}</td>
            </tr>

            <tr>
              <td class="record__property">Financiamiento</td>
              <td>{{ record.financiamiento }}</td>
            </tr>

            <tr>
              <td class="record__property">Status</td>
              <td>{{ record.status }}</td>
            </tr>

            <tr>
              <td class="record__property">A&ntilde;o</td>
              <td>{{ record.ano_aprobacion }}</td>
            </tr>

            <tr>
              <td class="record__property">Observaciones</td>
              <td>{{ record.observaciones }}</td>
            </tr>

            <tr>
              <td class="record__property">Fuente</td>
              <td class="record__property"><a ng-href="{{ record.fuente }}" target="_blank">{{ record.fuente | limitTo: 80 }}...</a></td>
            </tr>
          </table>
        </accordion-group>
      </accordion>
    </ul>
  </div>

  <div class="pagination-centered">
    <dir-pagination-controls template-url="views/pagination.tpl.html"></dir-pagination-controls>
  </div>
</div>
